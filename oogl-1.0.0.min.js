/*! Object-Oriented Graphics Library - v1.0.0 - 2012-12-26
* Released under the MIT License
* http://oogljs.com/
* Copyright (c) 2012 Alberto La Rocca */
var OOGL=function(e){typeof e=="function"&&document.addEventListener("DOMContentLoaded",e,!1)};typeof $=="undefined"&&($=OOGL),OOGL.Ajax=new function(){function t(e){var t="XMLHttpRequest"in window?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return t.onreadystatechange=e,t}function n(n,r,i){var s=new t(function(){s.readyState===4&&(s.status===200?i(s.responseText):e())});s.open(n,r),s.send()}function r(n,r,i){var s=new t(function(){s.readyState===4&&(s.status===200?i(JSON.parse(s.responseText)):e())});s.open(n,r),s.send()}var e=function(){};this.onError=function(t){e=t||function(){}},this.get=function(e,t){n("GET",e,t)},this.getJSON=function(e,t){r("GET",e,t)},this.post=function(e,t){n("POST",e,t)},this.postJSON=function(e,t){r("POST",e,t)},this.put=function(e,t){n("PUT",e,t)},this.putJSON=function(e,t){r("PUT",e,t)},this._delete=function(e,t){n("DELETE",e,t)},this.deleteJSON=function(e,t){r("DELETE",e,t)}},OOGL.Vector2=function(e,t){this.x=e,this.y=t},OOGL.Vector2.prototype={length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return this.x/=e,this.y/=e,this},getNormalized:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return new OOGL.Vector2(this.x/e,this.y/e)},add:function(e){return this.x+=e.x,this.y+=e.y,this},plus:function(e){return new OOGL.Vector2(this.x+e.x,this.y+e.y)},subtract:function(e){return this.x-=e.x,this.y-=e.y,this},minus:function(e){return new OOGL.Vector2(this.x-e.x,this.y-e.y)},multiply:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e,this.y/=e,this},by:function(e){return new OOGL.Vector2(this.x*e,this.y*e)},dot:function(e){return this.x*e.x+this.y*e.y},reflect:function(e){var t=this.x*e.x+this.y*e.y;return this.x-=2*t*e.x,this.y-=2*t*e.y,this},getReflected:function(e){var t=this.x*e.x+this.y*e.y;return new OOGL.Vector2(this.x-2*t*e.x,this.y-2*t*e.y)},refract:function(e,t){var n=this.x*e.x+this.y*e.y,r=1-t*t*(1-n*n);return r<0?(this.x=0,this.y=0):(this.x=t*this.x-(t*n+Math.sqrt(r))*e.x,this.y=t*this.y-(t*n+Math.sqrt(r))*e.y),this},getRefracted:function(e,t){var n=this.x*e.x+this.y*e.y,r=1-t*t*(1-n*n);return r<0?OOGL.Vector2.NULL:new OOGL.Vector2(t*this.x-(t*n+Math.sqrt(r))*e.x,t*this.y-(t*n+Math.sqrt(r))*e.y)}},OOGL.Vector2.NULL=new OOGL.Vector2(0,0),OOGL.Vector2.I=new OOGL.Vector2(1,0),OOGL.Vector2.J=new OOGL.Vector2(0,1),OOGL.Vector3=function(e,t,n){this.x=e,this.y=t,this.z=n},OOGL.Vector3.prototype={toHomogeneous:function(){return new OOGL.Vector4(this.x,this.y,this.z,1)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.x/=e,this.y/=e,this.z/=e,this},getNormal:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return new OOGL.Vector3(this.x/e,this.y/e,this.z/e)},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},plus:function(e){return new OOGL.Vector3(this.x+e.x,this.y+e.y,this.z+e.z)},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},minus:function(e){return new OOGL.Vector3(this.x-e.x,this.y-e.y,this.z-e.z)},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this},by:function(e){return new OOGL.Vector3(this.x*e,this.y*e,this.z*e)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},cross:function(e){var t=this.y*e.z-this.z*e.y,n=this.z*e.x-this.x*e.z,r=this.x*e.y-this.y*e.x;return this.x=t,this.y=n,this.z=r,this},getCrossProduct:function(e){return new OOGL.Vector3(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},reflect:function(e){var t=this.x*e.x+this.y*e.y+this.z*e.z;return this.x-=2*t*e.x,this.y-=2*t*e.y,this.z-=2*t*e.z,this},getReflected:function(e){var t=this.x*e.x+this.y*e.y+this.z*e.z;return new OOGL.Vector3(this.x-2*t*e.x,this.y-2*t*e.y,this.z-2*t*e.z)},refract:function(e,t){var n=this.x*e.x+this.y*e.y+this.z*e.z,r=1-t*t*(1-n*n);return r<0?(this.x=0,this.y=0,this.z=0):(this.x=t*this.x-(t*n+Math.sqrt(r))*e.x,this.y=t*this.y-(t*n+Math.sqrt(r))*e.y,this.z=t*this.z-(t*n+Math.sqrt(r))*e.z),this},getRefracted:function(e,t){var n=this.x*e.x+this.y*e.y+this.z*e.z,r=1-t*t*(1-n*n);return r<0?OOGL.Vector3.NULL:new OOGL.Vector3(t*this.x-(t*n+Math.sqrt(r))*e.x,t*this.y-(t*n+Math.sqrt(r))*e.y,t*this.z-(t*n+Math.sqrt(r))*e.z)}},OOGL.Vector3.NULL=new OOGL.Vector3(0,0,0),OOGL.Vector3.I=new OOGL.Vector3(1,0,0),OOGL.Vector3.J=new OOGL.Vector3(0,1,0),OOGL.Vector3.K=new OOGL.Vector3(0,0,1),OOGL.Vector4=function(e,t,n,r){this.x=e,this.y=t,this.z=n,this.w=r},OOGL.Vector4.prototype={toStandard:function(){return new OOGL.Vector3(this.x/this.w,this.y/this.w,this.z/this.w)}},OOGL.Matrix2=function(e){if(e.length!=4)throw"A 2x2 matrix must have exactly 4 elements.";return e.slice(0)},OOGL.Matrix2.prototype={get:function(e,t){return this[e*2+t]},put:function(e,t,n){return this[e*2+t]=n,this},transpose:function(){var e=[this[0],this[2],this[1],this[3]];for(var t=0;t<4;t++)this[t]=e[t];return this},getTransposed:function(){return new OOGL.Matrix2([this[0],this[2],this[1],this[3]])},add:function(e){for(var t=0;t<4;t++)this[t]+=e[t];return this},plus:function(e){var t=[];for(var n=0;n<4;n++)t.push(this[n]+e[n]);return new OOGL.Matrix2(t)},subtract:function(e){for(var t=0;t<4;t++)this[t]-=e[t];return this},minus:function(e){var t=[];for(var n=0;n<4;n++)t.push(this[n]-e[n]);return new OOGL.Matrix2(t)},multiply:function(e){for(var t=0;t<4;t++)this[t]*=e;return this},by:function(e){if(e instanceof OOGL.Vector2)return new OOGL.Vector2(this[0]*e.x+this[1]*e.y,this[2]*e.x+this[3]*e.y);var t=[];for(var n=0;n<4;n++)t.push(this[n]*e);return new OOGL.Matrix2(t)},determinant:function(){return this[0]*this[1]-this[2]*this[3]},invert:function(){var e=this[0]*this[1]-this[2]*this[3],t=[this[3]/e,this[1]/e,this[2]/e,this[0]/e];for(var n=0;n<4;n++)this[n]=t[n];return this},getInverse:function(){var e=this[0]*this[1]-this[2]*this[3];return new OOGL.Matrix2([this[3]/e,this[1]/e,this[2]/e,this[0]/e])}},OOGL.Matrix2.NULL=new OOGL.Matrix2([0,0,0,0]),OOGL.Matrix2.IDENTITY=new OOGL.Matrix2([1,0,0,1]),OOGL.RotationMatrix2=function(e){var t=Math.sin(e),n=Math.cos(e);return new OOGL.Matrix2([n,-t,t,n])},OOGL.ScalingMatrix2=function(e,t){return new OOGL.Matrix2([e,0,0,t])},OOGL.Matrix3=function(e){if(e.length!=9)throw"A 3x3 matrix must have exactly 9 elements.";return e.slice(0)},OOGL.Matrix3.prototype={toHomogeneous:function(){return new OOGL.Matrix4([this[0],this[1],this[2],0,this[3],this[4],this[5],0,this[6],this[7],this[8],0,0,0,0,1])},get:function(e,t){return this[e*3+t]},put:function(e,t,n){return this[e*3+t]=n,this},transpose:function(){var e=[this[0],this[3],this[6],this[1],this[4],this[7],this[2],this[5],this[8]];for(var t=0;t<9;t++)this[t]=e[t];return this},getTransposed:function(){return new OOGL.Matrix3([this[0],this[3],this[6],this[1],this[4],this[7],this[2],this[5],this[8]])},add:function(e){for(var t=0;t<9;t++)this[t]+=e[t];return this},plus:function(e){var t=[];for(var n=0;n<9;n++)t.push(this[n]+e[n]);return new OOGL.Matrix3(t)},subtract:function(e){for(var t=0;t<9;t++)this[t]-=e[t];return this},minus:function(e){var t=[];for(var n=0;n<9;n++)t.push(this[n]-e[n]);return new OOGL.Matrix3(t)},multiply:function(e){for(var t=0;t<9;t++)this[t]*=e;return this},by:function(e){if(e instanceof OOGL.Vector3)return new OOGL.Vector3(this[0]*e.x+this[1]*e.y+this[2]*e.z,this[3]*e.x+this[4]*e.y+this[5]*e.z,this[6]*e.x+this[7]*e.y+this[8]*e.z);var t=[];for(var n=0;n<9;n++)t.push(this[n]*e);return new OOGL.Matrix3(t)},determinant:function(){return this[0]*(this[4]*this[8]-this[5]*this[7])-this[1]*(this[3]*this[8]-this[5]*this[6])+this[2]*(this[3]*this[7]-this[4]*this[6])},invert:function(){var e=this[0]*(this[4]*this[8]-this[5]*this[7])-this[1]*(this[3]*this[8]-this[5]*this[6])+this[2]*(this[3]*this[7]-this[4]*this[6]),t=[(this[4]*this[8]-this[5]*this[7])/e,(this[2]*this[7]-this[1]*this[8])/e,(this[1]*this[5]-this[2]*this[4])/e,(this[5]*this[6]-this[3]*this[8])/e,(this[0]*this[8]-this[2]*this[6])/e,(this[2]*this[3]-this[0]*this[5])/e,(this[3]*this[7]-this[4]*this[6])/e,(this[1]*this[6]-this[0]*this[7])/e,(this[0]*this[4]-this[1]*this[3])/e];for(var n=0;n<9;n++)this[n]=t[n];return this},getInverse:function(){var e=this[0]*(this[4]*this[8]-this[5]*this[7])-this[1]*(this[3]*this[8]-this[5]*this[6])+this[2]*(this[3]*this[7]-this[4]*this[6]);return new OOGL.Matrix3([(this[4]*this[8]-this[5]*this[7])/e,(this[2]*this[7]-this[1]*this[8])/e,(this[1]*this[5]-this[2]*this[4])/e,(this[5]*this[6]-this[3]*this[8])/e,(this[0]*this[8]-this[2]*this[6])/e,(this[2]*this[3]-this[0]*this[5])/e,(this[3]*this[7]-this[4]*this[6])/e,(this[1]*this[6]-this[0]*this[7])/e,(this[0]*this[4]-this[1]*this[3])/e])}},OOGL.Matrix3.NULL=new OOGL.Matrix3([0,0,0,0,0,0,0,0,0]),OOGL.Matrix3.IDENTITY=new OOGL.Matrix3([1,0,0,0,1,0,0,0,1]),OOGL.RotationMatrix3=function(e,t,n,r){var i=Math.sin(r),s=Math.cos(r);return new OOGL.Matrix3([s+e*e*(1-s),t*e*(1-s)+n*i,n*e*(1-s)-t*i,e*t*(1-s)-n*i,s+t*t*(1-s),n*t*(1-s)+e*i,e*n*(1-s)+t*i,t*n*(1-s)-e*i,s+n*n*(1-s)])},OOGL.ScalingMatrix3=function(e,t,n){return new OOGL.Matrix3([e,0,0,0,t,0,0,0,n])},OOGL.Matrix4=function(e){if(e.length!=16)throw"A 4x4 matrix must have exactly 16 elements.";return e.slice(0)},OOGL.Matrix4.prototype={get:function(e,t){return this[e*4+t]},put:function(e,t,n){return this[e*4+t]=n,this}},OOGL.TranslationMatrix4=function(e,t,n){return new OOGL.Matrix4([1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1])},OOGL.RotationMatrix4=function(e,t,n,r){var i=Math.sin(r),s=Math.cos(r);return new OOGL.Matrix4([s+e*e*(1-s),t*e*(1-s)+n*i,n*e*(1-s)-t*i,0,e*t*(1-s)-n*i,s+t*t*(1-s),n*t*(1-s)+e*i,0,e*n*(1-s)+t*i,t*n*(1-s)-e*i,s+n*n*(1-s),0,0,0,0,1])},OOGL.ScalingMatrix4=function(e,t,n){return new OOGL.Matrix4([e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1])},OOGL.Context=function(e,t){var n;typeof e!="string"?n=e:n=document.getElementById(e);var r=n.getContext("webgl",t);r||(r=n.getContext("experimental-webgl",t));if(!r)throw"WebGL not supported.";return r.Buffer=function(){var e={"byte":Int8Array,ubyte:Uint8Array,"short":Int16Array,ushort:Uint16Array,"float":Float32Array};return function(t,n,i){var s;if(!e.hasOwnProperty(n))throw'Invalid buffer type, must be one of "byte", "ubyte", "short", "ushort" and "float".';s=e[n];var o=r.createBuffer(t);return o.is=function(){return r.isBuffer(o)},o.getParameter=function(e){return r.getBufferParameter(t,e)},o.getSize=function(){return r.getBufferParameter(t,r.BUFFER_SIZE)},o.getUsage=function(){return r.getBufferParameter(t,r.BUFFER_USAGE)},o.bind=function(){r.bindBuffer(t,o)},o.data=function(e){typeof e!="number"&&(e=new s(e)),r.bufferData(t,e,i)},o.subData=function(e,n){r.bufferSubData(t,e,new s(n))},o._delete=function(){r.deleteBuffer(o)},o}}(),r.StaticBuffer=function(e,t){return new r.Buffer(e,t,r.STATIC_DRAW)},r.StreamBuffer=function(e,t){return new r.Buffer(e,t,r.STREAM_DRAW)},r.DynamicBuffer=function(e,t){return new r.Buffer(e,t,r.DYNAMIC_DRAW)},r.ArrayBuffer=function(e,t){return new r.Buffer(r.ARRAY_BUFFER,e,t)},r.ElementArrayBuffer=function(e,t){return new r.Buffer(r.ELEMENT_ARRAY_BUFFER,e,t)},r.StaticArrayBuffer=function(e){return new r.StaticBuffer(r.ARRAY_BUFFER,e)},r.StaticElementArrayBuffer=function(e){return new r.StaticBuffer(r.ELEMENT_ARRAY_BUFFER,e)},r.StreamArrayBuffer=function(e){return new r.StreamBuffer(r.ARRAY_BUFFER,e)},r.StreamElementArrayBuffer=function(e){return new r.StreamBuffer(r.ELEMENT_ARRAY_BUFFER,e)},r.DynamicArrayBuffer=function(e){return new r.DynamicBuffer(r.ARRAY_BUFFER,e)},r.DynamicElementArrayBuffer=function(e){return new r.DynamicBuffer(r.ELEMENT_ARRAY_BUFFER,e)},r.AttributeArray1=function(e,t,n,i){var s={"byte":{glType:r.BYTE,size:1},ubyte:{glType:r.UNSIGNED_BYTE,size:1},"short":{glType:r.SHORT,size:2},ushort:{glType:r.UNSIGNED_SHORT,size:2},"float":{glType:r.FLOAT,size:4}};if(!s.hasOwnProperty(t))throw'Invalid attribute type, must be one of "byte", "ubyte", "short", "ushort" and "float".';var o=new r.StaticArrayBuffer(t);return r.enableVertexAttribArray(e),o.pointer=function(n,o){arguments.length<2&&(o=0,arguments.length<1&&(n=0)),r.vertexAttribPointer(e,1,s[t].glType,!!i,n*s[t].size,o*s[t].size)},o},r.AttributeArray2=function(e,t,n,i){var s={"byte":{glType:r.BYTE,size:1},ubyte:{glType:r.UNSIGNED_BYTE,size:1},"short":{glType:r.SHORT,size:2},ushort:{glType:r.UNSIGNED_SHORT,size:2},"float":{glType:r.FLOAT,size:4}};if(!s.hasOwnProperty(t))throw'Invalid attribute type, must be one of "byte", "ubyte", "short", "ushort" and "float".';var o=new r.StaticArrayBuffer(t);return r.enableVertexAttribArray(e),o.pointer=function(n,o){arguments.length<2&&(o=0,arguments.length<1&&(n=0)),r.vertexAttribPointer(e,2,s[t].glType,!!i,n*s[t].size,o*s[t].size)},o},r.AttributeArray3=function(e,t,n,i){var s={"byte":{glType:r.BYTE,size:1},ubyte:{glType:r.UNSIGNED_BYTE,size:1},"short":{glType:r.SHORT,size:2},ushort:{glType:r.UNSIGNED_SHORT,size:2},"float":{glType:r.FLOAT,size:4}};if(!s.hasOwnProperty(t))throw'Invalid attribute type, must be one of "byte", "ubyte", "short", "ushort" and "float".';var o=new r.StaticArrayBuffer(t);return r.enableVertexAttribArray(e),o.pointer=function(n,o){arguments.length<2&&(o=0,arguments.length<1&&(n=0)),r.vertexAttribPointer(e,3,s[t].glType,!!i,n*s[t].size,o*s[t].size)},o},r.AttributeArray4=function(e,t,n,i){var s={"byte":{glType:r.BYTE,size:1},ubyte:{glType:r.UNSIGNED_BYTE,size:1},"short":{glType:r.SHORT,size:2},ushort:{glType:r.UNSIGNED_SHORT,size:2},"float":{glType:r.FLOAT,size:4}};if(!s.hasOwnProperty(t))throw'Invalid attribute type, must be one of "byte", "ubyte", "short", "ushort" and "float".';var o=new r.StaticArrayBuffer(t);return r.enableVertexAttribArray(e),o.pointer=function(n,o){arguments.length<2&&(o=0,arguments.length<1&&(n=0)),r.vertexAttribPointer(e,4,s[t].glType,!!i,n*s[t].size,o*s[t].size)},o},r.AttributeArrays=function(e){var t=[];return{add1:function(e,n,i){t.push(new r.AttributeArray1(t.length,e,n,i))},add2:function(e,n,i){t.push(new r.AttributeArray2(t.length,e,n,i))},add3:function(e,n,i){t.push(new r.AttributeArray3(t.length,e,n,i))},add4:function(e,n,i){t.push(new r.AttributeArray4(t.length,e,n,i))},bindAndPointer:function(e,n){for(var r in t)t[r].bind(),t[r].pointer(e,n)},drawTriangles:function(e){return function(t,n){arguments.length<2&&(n=e,arguments.length<1&&(t=0)),r.drawArrays(r.TRIANGLES,t,n)}}(e),drawTriangleFan:function(e){return function(t,n){arguments.length<2&&(n=e,arguments.length<1&&(t=0)),r.drawArrays(r.TRIANGLE_FAN,t,n)}}(e),drawTriangleStrip:function(e){return function(t,n){arguments.length<2&&(n=e,arguments.length<1&&(t=0)),r.drawArrays(r.TRIANGLE_STRIP,t,n)}}(e),_delete:function(){for(var e in t)t[e]._delete()}}},r.ElementArray=function(e,t){var n=e.length,i={ubyte:r.UNSIGNED_BYTE,ushort:r.UNSIGNED_SHORT};if(!i.hasOwnProperty(t||"ushort"))throw'Invalid element type, must be either "ubyte" or "ubyte".';var s=new r.StaticElementArrayBuffer(i[t]);return s.bind(),s.data(e),s.drawTriangles=function(e){return function(n,s){arguments.length<2&&(s=e,arguments.length<1&&(n=0)),r.drawElements(r.TRIANGLES,s,i[t],n)}}(n),s.drawTriangleFan=function(e){return function(n,s){arguments.length<2&&(s=e,arguments.length<1&&(n=0)),r.drawElements(r.TRIANGLE_FAN,s,i[t],n)}}(n),s.drawTriangleStrip=function(e){return function(n,s){arguments.length<2&&(s=e,arguments.length<1&&(n=0)),r.drawElements(r.TRIANGLE_STRIP,s,i[t],n)}}(n),s},r.Texture=function(e){var t=r.createTexture();return t.bind=function(){r.bindTexture(e,t)},t.getParameter=function(t){return r.getTexParameter(e,t)},t.parameterf=function(t,n){r.texParameterf(e,t,n)},t.parameteri=function(t,n){r.texParameteri(e,t,n)},t.generateMipmap=function(){r.generateMipmap(e)},t.image2D=function(){},t.subImage2D=function(){},t.copyImage2D=function(){},t._delete=function(){r.deleteTexture(t)},t},r.Texture2D=function(){return new r.Texture(r.TEXTURE_2D)},r.CubeMap=function(){return new r.Texture(r.TEXTURE_CUBE_MAP)},r.Textures=function(e){return e=e.slice(0),{bind:function(){for(var t=0;t<e.length;t++)r.activeTexture(r.TEXTURE0+t),e[t].bind()},uniform:function(t,n){for(var r=0;r<e.length;r++)t.uniform1i(n[r],r)},_delete:function(){for(var t in e)e[t]._delete();e=[]}}},r.Shader=function(e){var t=r.createShader(e);return t.getParameter=function(e){return r.getShaderParameter(t,e)},t.getType=function(){return r.getShaderParameter(t,r.SHADER_TYPE)},t.source=function(e){r.shaderSource(t,e)},t.getSource=function(){return r.getShaderParameter(t,r.SHADER_SOURCE)},t.compile=function(){r.compileShader(t)},t.getCompileStatus=function(){return r.getShaderParameter(t,r.COMPILE_STATUS)},t.getInfoLog=function(){return r.getShaderInfoLog(t)},t.compileOrThrow=function(){r.compileShader(t);if(!r.getShaderParameter(t,r.COMPILE_STATUS))throw r.getShaderInfoLog(t)},t._delete=function(){r.deleteShader(t)},t.getDeleteStatus=function(){return r.getShaderParameter(t,r.DELETE_STATUS)},t},r.VertexShader=function(e){var t=new r.Shader(r.VERTEX_SHADER);return e&&(t.source(e),t.compileOrThrow()),t},r.FragmentShader=function(e){var t=new r.Shader(r.FRAGMENT_SHADER);return e&&(t.source(e),t.compileOrThrow()),t},r.AjaxVertexShader=function(e,t){var n=new r.Shader(r.VERTEX_SHADER);return OOGL.Ajax.get(e+".vert",function(e){n.source(e),n.compileOrThrow(),t&&t()}),n},r.AjaxFragmentShader=function(e,t){var n=new r.Shader(r.FRAGMENT_SHADER);return OOGL.Ajax.get(e+".frag",function(e){n.source(e),n.compileOrThrow(),t&&t()}),n},r.Program=function(){var e=r.createProgram(),t={};return e.getParameter=function(t){return r.getProgramParameter(e,t)},e.attachShader=function(t){r.attachShader(e,t)},e.detachShader=function(t){r.detachShader(e,t)},e.bindAttribLocation=function(t,n){r.bindAttribLocation(e,t,n)},e.bindAttribLocations=function(t){for(var n=0;n<t.length;n++)r.bindAttribLocation(e,n,t[n])},e.link=function(){t={},r.linkProgram(e)},e.getLinkStatus=function(){return r.getProgramParameter(e,r.LINK_STATUS)},e.getInfoLog=function(){return r.getProgramInfoLog(e)},e.linkOrThrow=function(){r.linkProgram(e);if(!r.getProgramParameter(e,r.LINK_STATUS))throw r.getProgramInfoLog(e)},e.use=function(){r.useProgram(e)},e.validate=function(){return r.validateProgram(e),r.getProgramParameter(e,r.VALIDATE_STATUS)},e.getActiveAttrib=function(t){return r.getActiveAttrib(e,t)},e.getActiveUniform=function(t){return r.getActiveUniform(e,t)},e.getAttribLocation=function(t){return r.getAttribLocation(e,t)},e.getUniform=function(n){return typeof n!="string"?r.getUniform(e,n):r.getUniform(e,t[n]||(t[n]=r.getUniformLocation(e,n)))},e.getUniformLocation=function(n){return t[n]=r.getUniformLocation(e,n)},e._delete=function(){r.deleteProgram(e)},e.getDeleteStatus=function(){return r.getProgramParameter(e,r.DELETE_STATUS)},e},r.AutoProgram=function(e,t,n){var i=new r.Program;return i.attachShader(new r.VertexShader(e)),i.attachShader(new r.FragmentShader(t)),i.bindAttribLocations(n),i.linkOrThrow(),i},r.AjaxProgram=function(e,t,n){var i=new r.Program,s=new r.VertexShader(e,function(){i.attachShader(s);var o=new r.FragmentShader(e,function(){i.attachShader(o),i.bindAttribLocations(t),i.linkOrThrow(),n&&n()})});return i},r.Framebuffer=function(){var e=r.createFramebuffer();return e.getAttachmentParameter=function(e,t){return r.getFramebufferAttachmentParameter(r.FRAMEBUFFER,e,t)},e.bind=function(){r.bindFramebuffer(r.FRAMEBUFFER,e)},e.checkStatus=function(){return r.checkFramebufferStatus(r.FRAMEBUFFER)},e.renderbuffer=function(e,t){r.framebufferRenderbuffer(r.FRAMEBUFFER,e,r.RENDERBUFFER,t)},e.texture2D=function(e,t,n,i){r.framebufferTexture2D(r.FRAMEBUFFER,e,t,n,i)},e._delete=function(){r.deleteFramebuffer(e)},e},r.Renderbuffer=function(){var e=r.createRenderbuffer();return e.getParameter=function(e){return r.getRenderbufferParameter(r.RENDERBUFFER,e)},e.getWidth=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_WIDTH)},e.getHeight=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_HEIGHT)},e.getInternalFormat=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_INTERNAL_FORMAT)},e.getRedSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_RED_SIZE)},e.getGreenSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_GREEN_SIZE)},e.getBlueSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_BLUE_SIZE)},e.getAlphaSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_ALPHA_SIZE)},e.getDepthSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_DEPTH_SIZE)},e.getStencilSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_STENCIL_SIZE)},e.bind=function(){r.bindRenderbuffer(r.RENDERBUFFER,e)},e.storage=function(e,t,n){r.renderbufferStorage(r.RENDERBUFFER,e,t,n)},e._delete=function(){r.deleteRenderbuffer(e)},e},r};