/*! Object-Oriented Graphics Library - v1.0.0 - 2013-01-06
* Released under the MIT License
* http://oogljs.com/
* Copyright (c) 2013 Alberto La Rocca */
var OOGL=function(e){typeof e=="function"&&document.addEventListener("DOMContentLoaded",function(){e.call(OOGL,OOGL)},!1)};typeof $=="undefined"&&($=OOGL),OOGL.Ajax=new function(){function t(e){var t="XMLHttpRequest"in window?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return t.onreadystatechange=e,t}function n(n,r,i){var s=new t(function(){s.readyState===4&&(s.status===200?i(s.responseText):e())});s.open(n,r),s.send()}function r(n,r,i){var s=new t(function(){s.readyState===4&&(s.status===200?i(JSON.parse(s.responseText)):e())});s.open(n,r),s.send()}var e=function(){};this.onError=function(t){e=t||function(){}},this.get=function(e,t){n("GET",e,t)},this.getJSON=function(e,t){r("GET",e,t)},this.post=function(e,t){n("POST",e,t)},this.postJSON=function(e,t){r("POST",e,t)},this.put=function(e,t){n("PUT",e,t)},this.putJSON=function(e,t){r("PUT",e,t)},this._delete=function(e,t){n("DELETE",e,t)},this.deleteJSON=function(e,t){r("DELETE",e,t)}},OOGL.Vector2=function(e,t){this.x=e,this.y=t},OOGL.Vector2.prototype={clone:function(){return new OOGL.Vector2(this.x,this.y)},toArray:function(){return[this.x,this.y]},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return this.x/=e,this.y/=e,this},getNormalized:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y);return new OOGL.Vector2(this.x/e,this.y/e)},add:function(e){return this.x+=e.x,this.y+=e.y,this},plus:function(e){return new OOGL.Vector2(this.x+e.x,this.y+e.y)},subtract:function(e){return this.x-=e.x,this.y-=e.y,this},minus:function(e){return new OOGL.Vector2(this.x-e.x,this.y-e.y)},multiply:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e,this.y/=e,this},by:function(e){return new OOGL.Vector2(this.x*e,this.y*e)},dot:function(e){return this.x*e.x+this.y*e.y},reflect:function(e){var t=this.x*e.x+this.y*e.y;return this.x-=2*t*e.x,this.y-=2*t*e.y,this},getReflected:function(e){var t=this.x*e.x+this.y*e.y;return new OOGL.Vector2(this.x-2*t*e.x,this.y-2*t*e.y)},refract:function(e,t){var n=this.x*e.x+this.y*e.y,r=1-t*t*(1-n*n);return r<0?(this.x=0,this.y=0):(this.x=t*this.x-(t*n+Math.sqrt(r))*e.x,this.y=t*this.y-(t*n+Math.sqrt(r))*e.y),this},getRefracted:function(e,t){var n=this.x*e.x+this.y*e.y,r=1-t*t*(1-n*n);return r<0?OOGL.Vector2.NULL:new OOGL.Vector2(t*this.x-(t*n+Math.sqrt(r))*e.x,t*this.y-(t*n+Math.sqrt(r))*e.y)}},OOGL.Vector2.NULL=new OOGL.Vector2(0,0),OOGL.Vector2.I=new OOGL.Vector2(1,0),OOGL.Vector2.J=new OOGL.Vector2(0,1),OOGL.Vector3=function(e,t,n){this.x=e,this.y=t,this.z=n},OOGL.Vector3.prototype={clone:function(){return new OOGL.Vector3(this.x,this.y,this.z)},toArray:function(){return[this.x,this.y,this.z]},toHomogeneous:function(){return new OOGL.Vector4(this.x,this.y,this.z,1)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.x/=e,this.y/=e,this.z/=e,this},getNormal:function(){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return new OOGL.Vector3(this.x/e,this.y/e,this.z/e)},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},plus:function(e){return new OOGL.Vector3(this.x+e.x,this.y+e.y,this.z+e.z)},subtract:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},minus:function(e){return new OOGL.Vector3(this.x-e.x,this.y-e.y,this.z-e.z)},multiply:function(e){return this.x*=e,this.y*=e,this.z*=e,this},divide:function(e){return this.x/=e,this.y/=e,this.z/=e,this},by:function(e){return new OOGL.Vector3(this.x*e,this.y*e,this.z*e)},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},cross:function(e){var t=this.y*e.z-this.z*e.y,n=this.z*e.x-this.x*e.z,r=this.x*e.y-this.y*e.x;return this.x=t,this.y=n,this.z=r,this},getCrossProduct:function(e){return new OOGL.Vector3(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},reflect:function(e){var t=this.x*e.x+this.y*e.y+this.z*e.z;return this.x-=2*t*e.x,this.y-=2*t*e.y,this.z-=2*t*e.z,this},getReflected:function(e){var t=this.x*e.x+this.y*e.y+this.z*e.z;return new OOGL.Vector3(this.x-2*t*e.x,this.y-2*t*e.y,this.z-2*t*e.z)},refract:function(e,t){var n=this.x*e.x+this.y*e.y+this.z*e.z,r=1-t*t*(1-n*n);return r<0?(this.x=0,this.y=0,this.z=0):(this.x=t*this.x-(t*n+Math.sqrt(r))*e.x,this.y=t*this.y-(t*n+Math.sqrt(r))*e.y,this.z=t*this.z-(t*n+Math.sqrt(r))*e.z),this},getRefracted:function(e,t){var n=this.x*e.x+this.y*e.y+this.z*e.z,r=1-t*t*(1-n*n);return r<0?OOGL.Vector3.NULL:new OOGL.Vector3(t*this.x-(t*n+Math.sqrt(r))*e.x,t*this.y-(t*n+Math.sqrt(r))*e.y,t*this.z-(t*n+Math.sqrt(r))*e.z)}},OOGL.Vector3.NULL=new OOGL.Vector3(0,0,0),OOGL.Vector3.I=new OOGL.Vector3(1,0,0),OOGL.Vector3.J=new OOGL.Vector3(0,1,0),OOGL.Vector3.K=new OOGL.Vector3(0,0,1),OOGL.Vector4=function(e,t,n,r){this.x=e,this.y=t,this.z=n,this.w=r},OOGL.Vector4.prototype={clone:function(){return new OOGL.Vector4(this.x,this.y,this.z,this.w)},toArray:function(){return[this.x,this.y,this.z,this.w]},toStandard:function(){return new OOGL.Vector3(this.x/this.w,this.y/this.w,this.z/this.w)}},OOGL.Matrix2=function(e){if(e.length!=4)throw"A 2x2 matrix must have exactly 4 elements.";for(var t=0;t<4;t++)this[t]=e[t]},OOGL.Matrix2.prototype={get:function(e,t){return this[t*2+e]},put:function(e,t,n){return this[t*2+e]=n,this},transpose:function(){var e=[this[0],this[2],this[1],this[3]];for(var t=0;t<4;t++)this[t]=e[t];return this},getTransposed:function(){return new OOGL.Matrix2([this[0],this[2],this[1],this[3]])},add:function(e){for(var t=0;t<4;t++)this[t]+=e[t];return this},plus:function(e){var t=[];for(var n=0;n<4;n++)t.push(this[n]+e[n]);return new OOGL.Matrix2(t)},subtract:function(e){for(var t=0;t<4;t++)this[t]-=e[t];return this},minus:function(e){var t=[];for(var n=0;n<4;n++)t.push(this[n]-e[n]);return new OOGL.Matrix2(t)},multiply:function(e){for(var t=0;t<4;t++)this[t]*=e;return this},by:function(e){if(e instanceof OOGL.Vector2)return new OOGL.Vector2(this[0]*e.x+this[2]*e.y,this[1]*e.x+this[3]*e.y);if(e instanceof OOGL.Matrix2)return new OOGL.Matrix2([this[0]*e[0]+this[2]*e[1],this[1]*e[0]+this[3]*e[1],this[0]*e[2]+this[2]*e[3],this[1]*e[2]+this[3]*e[3]]);var t=[];for(var n=0;n<4;n++)t.push(this[n]*e);return new OOGL.Matrix2(t)},determinant:function(){return this[0]*this[3]-this[1]*this[2]},invert:function(){var e=this[0]*this[3]-this[1]*this[2],t=[this[3]/e,this[2]/e,this[1]/e,this[0]/e];for(var n=0;n<4;n++)this[n]=t[n];return this},getInverse:function(){var e=this[0]*this[3]-this[1]*this[2];return new OOGL.Matrix2([this[3]/e,this[2]/e,this[1]/e,this[0]/e])}},OOGL.Matrix2.NULL=new OOGL.Matrix2([0,0,0,0]),OOGL.Matrix2.IDENTITY=new OOGL.Matrix2([1,0,0,1]),OOGL.RotationMatrix2=function(e){var t=Math.sin(e),n=Math.cos(e);return new OOGL.Matrix2([n,t,-t,n])},OOGL.ScalingMatrix2=function(e,t){return new OOGL.Matrix2([e,0,0,t])},OOGL.Matrix3=function(e){if(e.length!=9)throw"A 3x3 matrix must have exactly 9 elements.";for(var t=0;t<9;t++)this[t]=e[t]},OOGL.Matrix3.prototype={toHomogeneous:function(){return new OOGL.Matrix4([this[0],this[1],this[2],0,this[3],this[4],this[5],0,this[6],this[7],this[8],0,0,0,0,1])},get:function(e,t){return this[t*3+e]},put:function(e,t,n){return this[t*3+e]=n,this},transpose:function(){var e=[this[0],this[3],this[6],this[1],this[4],this[7],this[2],this[5],this[8]];for(var t=0;t<9;t++)this[t]=e[t];return this},getTransposed:function(){return new OOGL.Matrix3([this[0],this[3],this[6],this[1],this[4],this[7],this[2],this[5],this[8]])},add:function(e){for(var t=0;t<9;t++)this[t]+=e[t];return this},plus:function(e){var t=[];for(var n=0;n<9;n++)t.push(this[n]+e[n]);return new OOGL.Matrix3(t)},subtract:function(e){for(var t=0;t<9;t++)this[t]-=e[t];return this},minus:function(e){var t=[];for(var n=0;n<9;n++)t.push(this[n]-e[n]);return new OOGL.Matrix3(t)},multiply:function(e){var t;if(e instanceof OOGL.Matrix3){var n=[this[0]*e[0]+this[3]*e[1]+this[6]*e[2],this[1]*e[0]+this[4]*e[1]+this[7]*e[2],this[2]*e[0]+this[5]*e[1]+this[8]*e[2],this[0]*e[3]+this[3]*e[4]+this[6]*e[5],this[1]*e[3]+this[4]*e[4]+this[7]*e[5],this[2]*e[3]+this[5]*e[4]+this[8]*e[5],this[0]*e[6]+this[3]*e[7]+this[6]*e[8],this[1]*e[6]+this[4]*e[7]+this[7]*e[8],this[2]*e[6]+this[5]*e[7]+this[8]*e[8]];for(t=0;t<9;t++)this[t]=n[t]}else for(t=0;t<9;t++)this[t]*=e;return this},by:function(e){if(e instanceof OOGL.Matrix3)return new OOGL.Matrix3([this[0]*e[0]+this[3]*e[1]+this[6]*e[2],this[1]*e[0]+this[4]*e[1]+this[7]*e[2],this[2]*e[0]+this[5]*e[1]+this[8]*e[2],this[0]*e[3]+this[3]*e[4]+this[6]*e[5],this[1]*e[3]+this[4]*e[4]+this[7]*e[5],this[2]*e[3]+this[5]*e[4]+this[8]*e[5],this[0]*e[6]+this[3]*e[7]+this[6]*e[8],this[1]*e[6]+this[4]*e[7]+this[7]*e[8],this[2]*e[6]+this[5]*e[7]+this[8]*e[8]]);if(e instanceof OOGL.Vector3)return new OOGL.Vector3(this[0]*e.x+this[3]*e.y+this[6]*e.z,this[1]*e.x+this[4]*e.y+this[7]*e.z,this[2]*e.x+this[5]*e.y+this[8]*e.z);var t=[];for(var n=0;n<9;n++)t.push(this[n]*e);return new OOGL.Matrix3(t)},determinant:function(){return this[0]*(this[4]*this[8]-this[5]*this[7])-this[3]*(this[1]*this[8]-this[2]*this[7])+this[6]*(this[1]*this[5]-this[2]*this[4])},invert:function(){var e=this[0]*(this[4]*this[8]-this[5]*this[7])-this[3]*(this[1]*this[8]-this[2]*this[7])+this[6]*(this[1]*this[5]-this[2]*this[4]),t=[(this[4]*this[8]-this[5]*this[7])/e,(this[2]*this[7]-this[1]*this[8])/e,(this[1]*this[5]-this[2]*this[4])/e,(this[5]*this[6]-this[3]*this[8])/e,(this[0]*this[8]-this[2]*this[6])/e,(this[2]*this[3]-this[0]*this[5])/e,(this[3]*this[7]-this[4]*this[6])/e,(this[1]*this[6]-this[0]*this[7])/e,(this[0]*this[4]-this[1]*this[3])/e];for(var n=0;n<9;n++)this[n]=t[n];return this},getInverse:function(){var e=this[0]*(this[4]*this[8]-this[5]*this[7])-this[3]*(this[1]*this[8]-this[2]*this[7])+this[6]*(this[1]*this[5]-this[2]*this[4]);return new OOGL.Matrix3([(this[4]*this[8]-this[5]*this[7])/e,(this[2]*this[7]-this[1]*this[8])/e,(this[1]*this[5]-this[2]*this[4])/e,(this[5]*this[6]-this[3]*this[8])/e,(this[0]*this[8]-this[2]*this[6])/e,(this[2]*this[3]-this[0]*this[5])/e,(this[3]*this[7]-this[4]*this[6])/e,(this[1]*this[6]-this[0]*this[7])/e,(this[0]*this[4]-this[1]*this[3])/e])}},OOGL.Matrix3.NULL=new OOGL.Matrix3([0,0,0,0,0,0,0,0,0]),OOGL.Matrix3.IDENTITY=new OOGL.Matrix3([1,0,0,0,1,0,0,0,1]),OOGL.RotationMatrix3=function(e,t,n,r){var i=Math.sin(r),s=Math.cos(r);return new OOGL.Matrix3([s+e*e*(1-s),e*t*(1-s)-n*i,e*n*(1-s)+t*i,t*e*(1-s)+n*i,s+t*t*(1-s),t*n*(1-s)-e*i,n*e*(1-s)-t*i,n*t*(1-s)+e*i,s+n*n*(1-s)])},OOGL.ScalingMatrix3=function(e,t,n){return new OOGL.Matrix3([e,0,0,0,t,0,0,0,n])},OOGL.Matrix4=function(e){if(e.length!=16)throw"A 4x4 matrix must have exactly 16 elements.";for(var t=0;t<16;t++)this[t]=e[t]},OOGL.Matrix4.prototype={get:function(e,t){return this[t*4+e]},put:function(e,t,n){return this[t*4+e]=n,this}},OOGL.TranslationMatrix4=function(e,t,n){return new OOGL.Matrix4([1,0,0,0,0,1,0,0,0,0,1,0,e,t,n,1])},OOGL.RotationMatrix4=function(e,t,n,r){var i=Math.sin(r),s=Math.cos(r);return new OOGL.Matrix4([s+e*e*(1-s),e*t*(1-s)-n*i,e*n*(1-s)+t*i,0,t*e*(1-s)+n*i,s+t*t*(1-s),t*n*(1-s)-e*i,0,n*e*(1-s)-t*i,n*t*(1-s)+e*i,s+n*n*(1-s),0,0,0,0,1])},OOGL.ScalingMatrix4=function(e,t,n){return new OOGL.Matrix4([e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1])},OOGL.Context=function(e,t){var n;typeof e!="string"?n=e:n=document.getElementById(e);var r=n.getContext("webgl",t);r||(r=n.getContext("experimental-webgl",t));if(!r)throw"WebGL not supported.";return r.Buffer=function(){var e={"byte":{constructor:Int8Array,size:1},ubyte:{constructor:Uint8Array,size:1},"short":{constructor:Int16Array,size:2},ushort:{constructor:Uint16Array,size:2},"float":{constructor:Float32Array,size:4}};return function(t,n,i){var s;if(!e.hasOwnProperty(n))throw'Invalid buffer type, must be one of "byte", "ubyte", "short", "ushort" and "float".';s=e[n].constructor;var o=r.createBuffer();return o.is=function(){return r.isBuffer(o)},o.getParameter=function(e){return r.getBufferParameter(t,e)},o.getSize=function(){return r.getBufferParameter(t,r.BUFFER_SIZE)},o.getUsage=function(){return r.getBufferParameter(t,r.BUFFER_USAGE)},o.bind=function(){r.bindBuffer(t,o)},o.data=function(s){typeof s!="number"&&(s=new e[n].constructor(s)),r.bufferData(t,s,i)},o.bindAndData=function(s){r.bindBuffer(t,o),typeof s!="number"&&(s=new e[n].constructor(s)),r.bufferData(t,s,i)},o.subData=function(i,s){r.bufferSubData(t,i*e[n].size,new e[n].constructor(s))},o._delete=function(){r.deleteBuffer(o)},o}}(),r.StaticBuffer=function(e,t){return new r.Buffer(e,t,r.STATIC_DRAW)},r.StreamBuffer=function(e,t){return new r.Buffer(e,t,r.STREAM_DRAW)},r.DynamicBuffer=function(e,t){return new r.Buffer(e,t,r.DYNAMIC_DRAW)},r.ArrayBuffer=function(e,t){return new r.Buffer(r.ARRAY_BUFFER,e,t)},r.ElementArrayBuffer=function(e,t){return new r.Buffer(r.ELEMENT_ARRAY_BUFFER,e,t)},r.StaticArrayBuffer=function(e){return new r.StaticBuffer(r.ARRAY_BUFFER,e)},r.StaticElementArrayBuffer=function(e){return new r.StaticBuffer(r.ELEMENT_ARRAY_BUFFER,e)},r.StreamArrayBuffer=function(e){return new r.StreamBuffer(r.ARRAY_BUFFER,e)},r.StreamElementArrayBuffer=function(e){return new r.StreamBuffer(r.ELEMENT_ARRAY_BUFFER,e)},r.DynamicArrayBuffer=function(e){return new r.DynamicBuffer(r.ARRAY_BUFFER,e)},r.DynamicElementArrayBuffer=function(e){return new r.DynamicBuffer(r.ELEMENT_ARRAY_BUFFER,e)},r.AttributeArray1=function(e,t,n,i){var s={"byte":{glType:r.BYTE,size:1},ubyte:{glType:r.UNSIGNED_BYTE,size:1},"short":{glType:r.SHORT,size:2},ushort:{glType:r.UNSIGNED_SHORT,size:2},"float":{glType:r.FLOAT,size:4}};if(!s.hasOwnProperty(t))throw'Invalid attribute type, must be one of "byte", "ubyte", "short", "ushort" and "float".';var o=new r.StaticArrayBuffer(t);return o.bindAndData(n),r.enableVertexAttribArray(e),o.pointer=function(n,o){r.vertexAttribPointer(e,1,s[t].glType,!!i,(n||0)*s[t].size,(o||0)*s[t].size)},o.bindAndPointer=function(n,u){r.bindBuffer(r.ARRAY_BUFFER,o),r.vertexAttribPointer(e,1,s[t].glType,!!i,(n||0)*s[t].size,(u||0)*s[t].size)},o},r.AttributeArray2=function(e,t,n,i){var s={"byte":{glType:r.BYTE,size:1},ubyte:{glType:r.UNSIGNED_BYTE,size:1},"short":{glType:r.SHORT,size:2},ushort:{glType:r.UNSIGNED_SHORT,size:2},"float":{glType:r.FLOAT,size:4}};if(!s.hasOwnProperty(t))throw'Invalid attribute type, must be one of "byte", "ubyte", "short", "ushort" and "float".';var o=new r.StaticArrayBuffer(t);return o.bindAndData(n),r.enableVertexAttribArray(e),o.pointer=function(n,o){r.vertexAttribPointer(e,2,s[t].glType,!!i,(n||0)*s[t].size,(o||0)*s[t].size)},o.bindAndPointer=function(n,u){r.bindBuffer(r.ARRAY_BUFFER,o),r.vertexAttribPointer(e,2,s[t].glType,!!i,(n||0)*s[t].size,(u||0)*s[t].size)},o},r.AttributeArray3=function(e,t,n,i){var s={"byte":{glType:r.BYTE,size:1},ubyte:{glType:r.UNSIGNED_BYTE,size:1},"short":{glType:r.SHORT,size:2},ushort:{glType:r.UNSIGNED_SHORT,size:2},"float":{glType:r.FLOAT,size:4}};if(!s.hasOwnProperty(t))throw'Invalid attribute type, must be one of "byte", "ubyte", "short", "ushort" and "float".';var o=new r.StaticArrayBuffer(t);return o.bindAndData(n),r.enableVertexAttribArray(e),o.pointer=function(n,o){r.vertexAttribPointer(e,3,s[t].glType,!!i,(n||0)*s[t].size,(o||0)*s[t].size)},o.bindAndPointer=function(n,u){r.bindBuffer(r.ARRAY_BUFFER,o),r.vertexAttribPointer(e,3,s[t].glType,!!i,(n||0)*s[t].size,(u||0)*s[t].size)},o},r.AttributeArray4=function(e,t,n,i){var s={"byte":{glType:r.BYTE,size:1},ubyte:{glType:r.UNSIGNED_BYTE,size:1},"short":{glType:r.SHORT,size:2},ushort:{glType:r.UNSIGNED_SHORT,size:2},"float":{glType:r.FLOAT,size:4}};if(!s.hasOwnProperty(t))throw'Invalid attribute type, must be one of "byte", "ubyte", "short", "ushort" and "float".';var o=new r.StaticArrayBuffer(t);return o.bindAndData(n),r.enableVertexAttribArray(e),o.pointer=function(n,o){r.vertexAttribPointer(e,4,s[t].glType,!!i,(n||0)*s[t].size,(o||0)*s[t].size)},o.bindAndPointer=function(n,u){r.bindBuffer(r.ARRAY_BUFFER,o),r.vertexAttribPointer(e,4,s[t].glType,!!i,(n||0)*s[t].size,(u||0)*s[t].size)},o},r.AttributeArrays=function(e){var t=[];return{add1:function(e,n,i){t.push(new r.AttributeArray1(t.length,e,n,i))},add2:function(e,n,i){t.push(new r.AttributeArray2(t.length,e,n,i))},add3:function(e,n,i){t.push(new r.AttributeArray3(t.length,e,n,i))},add4:function(e,n,i){t.push(new r.AttributeArray4(t.length,e,n,i))},bindAndPointer:function(e,n){for(var r in t)t[r].bindAndPointer(e,n)},drawTriangles:function(e){return function(t,n){arguments.length<2&&(n=e,arguments.length<1&&(t=0)),r.drawArrays(r.TRIANGLES,t,n)}}(e),drawTriangleFan:function(e){return function(t,n){arguments.length<2&&(n=e,arguments.length<1&&(t=0)),r.drawArrays(r.TRIANGLE_FAN,t,n)}}(e),drawTriangleStrip:function(e){return function(t,n){arguments.length<2&&(n=e,arguments.length<1&&(t=0)),r.drawArrays(r.TRIANGLE_STRIP,t,n)}}(e),_delete:function(){for(var e in t)t[e]._delete()}}},r.ElementArray=function(e,t){var n=e.length,i={ubyte:r.UNSIGNED_BYTE,ushort:r.UNSIGNED_SHORT};if(!i.hasOwnProperty(t||"ushort"))throw'Invalid element type, must be either "ubyte" or "ubyte".';var s=new r.StaticElementArrayBuffer(i[t]);return s.bindAndData(e),s.drawTriangles=function(e){return function(n,s){arguments.length<2&&(s=e,arguments.length<1&&(n=0)),r.drawElements(r.TRIANGLES,s,i[t],n)}}(n),s.drawTriangleFan=function(e){return function(n,s){arguments.length<2&&(s=e,arguments.length<1&&(n=0)),r.drawElements(r.TRIANGLE_FAN,s,i[t],n)}}(n),s.drawTriangleStrip=function(e){return function(n,s){arguments.length<2&&(s=e,arguments.length<1&&(n=0)),r.drawElements(r.TRIANGLE_STRIP,s,i[t],n)}}(n),s},r.Texture=function(e){var t=r.createTexture();return t.is=function(){return r.isTexture(t)},t.bind=function(){r.bindTexture(e,t)},t.getParameter=function(t){return r.getTexParameter(e,t)},t.getMinFilter=function(){return r.getTexParameter(e,r.TEXTURE_MIN_FILTER)},t.getMagFilter=function(){return r.getTexParameter(e,r.TEXTURE_MAG_FILTER)},t.getWrapS=function(){return r.getTexParameter(e,r.TEXTURE_WRAP_S)},t.getWrapT=function(){return r.getTexParameter(e,r.TEXTURE_WRAP_T)},t.parameterf=function(t,n){r.texParameterf(e,t,n)},t.parameteri=function(t,n){r.texParameteri(e,t,n)},t.setMinFilter=function(t){r.texParameteri(e,r.TEXTURE_MIN_FILTER,t)},t.setMagFilter=function(t){r.texParameteri(e,r.TEXTURE_MAG_FILTER,t)},t.setWrapS=function(t){r.texParameteri(e,r.TEXTURE_WRAP_S,t)},t.setWrapT=function(t){r.texParameteri(e,r.TEXTURE_WRAP_T,t)},t.generateMipmap=function(){r.generateMipmap(e)},t.image2D=function(t,n,i,s){r.texImage2D(e,t,n,n,i,s)},t.subImage2D=function(t,n,i,s,o,u){r.texSubImage2D(e,t,n,i,s,o,u)},t.copyImage2D=function(t,n,i,s,o,u,a){r.copyTexImage2D(e,t,n,i,s,o,u,a)},t.copySubImage2D=function(t,n,i,s,o,u,a){r.copyTexSubImage2D(e,t,n,i,s,o,u,a)},t._delete=function(){r.deleteTexture(t)},t},r.Texture2D=function(){return new r.Texture(r.TEXTURE_2D)},r.AutoTexture=function(e,t,n){var i=new r.Texture2D;return i.bind(),arguments.length>1?(i.setMagFilter(t),arguments.length>2?i.setMinFilter(n):i.setMinFilter(r.LINEAR)):(i.setMagFilter(r.LINEAR),i.setMinFilter(r.LINEAR)),i.image2D(0,r.RGBA,r.UNSIGNED_BYTE,e),i},r.AsyncTexture=function(e,t,n,i){var s=new r.Texture2D;return s.bind(),arguments.length>2?(s.setMagFilter(n),arguments.length>3?s.setMinFilter(i):s.setMinFilter(r.LINEAR)):(s.setMagFilter(r.LINEAR),s.setMinFilter(r.LINEAR)),s.image=new Image,s.image.onload=function(){s.image2D(0,r.RGBA,r.UNSIGNED_BYTE,s.image),t&&t.call(s)},s.image.src=e,s},r.CubeMap=function(){return new r.Texture(r.TEXTURE_CUBE_MAP)},r.Textures=function(e){var t={},n=[];for(var i in e)t[i]=!0,n.push({name:i,texture:e[i]});return{add:function(e,r){if(t.hasOwnProperty(e))throw"the specified name is already in use.";n.push({name:e,texture:r})},bind:function(){for(var e=0;e<n.length;e++)r.activeTexture(r.TEXTURE0+e),n[e].texture.bind()},uniform:function(e){for(var t=0;t<n.length;t++)e.uniform1i(n[t].name,t)},bindAndUniform:function(e){for(var t=0;t<n.length;t++)r.activeTexture(r.TEXTURE0+t),n[t].texture.bind(),e.uniform1i(n[t].name,t)},_delete:function(){for(var e in n)n[e].texture._delete();t={},n=[]}}},r.Shader=function(e){var t=r.createShader(e);return t.getParameter=function(e){return r.getShaderParameter(t,e)},t.getType=function(){return r.getShaderParameter(t,r.SHADER_TYPE)},t.source=function(e){r.shaderSource(t,e)},t.getSource=function(){return r.getShaderParameter(t,r.SHADER_SOURCE)},t.compile=function(){r.compileShader(t)},t.getCompileStatus=function(){return r.getShaderParameter(t,r.COMPILE_STATUS)},t.getInfoLog=function(){return r.getShaderInfoLog(t)},t.compileOrThrow=function(){r.compileShader(t);if(!r.getShaderParameter(t,r.COMPILE_STATUS))throw r.getShaderInfoLog(t)},t._delete=function(){r.deleteShader(t)},t.getDeleteStatus=function(){return r.getShaderParameter(t,r.DELETE_STATUS)},t},r.VertexShader=function(e){var t=new r.Shader(r.VERTEX_SHADER);return e&&(t.source(e),t.compileOrThrow()),t},r.FragmentShader=function(e){var t=new r.Shader(r.FRAGMENT_SHADER);return e&&(t.source(e),t.compileOrThrow()),t},r.AjaxVertexShader=function(e,t){var n=new r.Shader(r.VERTEX_SHADER);return OOGL.Ajax.get(e,function(e){n.source(e),n.compileOrThrow(),t&&t.call(n)}),n},r.AjaxFragmentShader=function(e,t){var n=new r.Shader(r.FRAGMENT_SHADER);return OOGL.Ajax.get(e,function(e){n.source(e),n.compileOrThrow(),t&&t.call(n)}),n},r.Program=function(){function n(n){return t[n]=r.getUniformLocation(e,n)}var e=r.createProgram(),t={};return e.getParameter=function(t){return r.getProgramParameter(e,t)},e.attachShader=function(t){r.attachShader(e,t)},e.detachShader=function(t){r.detachShader(e,t)},e.getAttachedShaders=function(){return r.getAttachedShaders(e)},e.getNumberOfAttachedShaders=function(){return r.getProgramParameter(e,r.ATTACHED_SHADERS)},e.bindAttribLocation=function(t,n){r.bindAttribLocation(e,t,n)},e.bindAttribLocations=function(t){for(var n in t)r.bindAttribLocation(e,parseInt(n,10),t[n])},e.link=function(){t={},r.linkProgram(e)},e.getLinkStatus=function(){return r.getProgramParameter(e,r.LINK_STATUS)},e.getInfoLog=function(){return r.getProgramInfoLog(e)},e.linkOrThrow=function(){t={},r.linkProgram(e);if(!r.getProgramParameter(e,r.LINK_STATUS))throw r.getProgramInfoLog(e)},e.use=function(){r.useProgram(e)},e.validate=function(){r.validateProgram(e)},e.getValidateStatus=function(){return r.getProgramParameter(e,r.VALIDATE_STATUS)},e.validateOrThrow=function(){r.validateProgram(e);if(!r.getProgramParameter(e,r.VALIDATE_STATUS))throw"program validation failed."},e.getActiveAttrib=function(t){return r.getActiveAttrib(e,t)},e.getNumberOfActiveAttributes=function(){return r.getProgramParameter(e,r.ACTIVE_ATTRIBUTES)},e.getActiveUniform=function(t){return r.getActiveUniform(e,t)},e.getNumberOfActiveUniforms=function(){return r.getProgramParameter(e,r.ACTIVE_UNIFORMS)},e.getAttribLocation=function(t){return r.getAttribLocation(e,t)},e.getUniform=function(n){return typeof n!="string"?r.getUniform(e,n):r.getUniform(e,t[n]||(t[n]=r.getUniformLocation(e,n)))},e.getUniformLocation=n,e.uniform1f=function(e,t){r.uniform1f(n(e),t)},e.uniform2f=function(e,t,i){r.uniform2f(n(e),t,i)},e.uniform3f=function(e,t,i,s){r.uniform3f(n(e),t,i,s)},e.uniform4f=function(e,t,i,s,o){r.uniform4f(n(e),t,i,s,o)},e.uniform1fv=function(e,t){r.uniform1fv(n(e),t)},e.uniform2fv=function(e,t){r.uniform2fv(n(e),t)},e.uniform3fv=function(e,t){r.uniform3fv(n(e),t)},e.uniform4fv=function(e,t){r.uniform4fv(n(e),t)},e.uniform1i=function(e,t){r.uniform1i(n(e),t)},e.uniform2i=function(e,t,i){r.uniform2i(n(e),t,i)},e.uniform3i=function(e,t,i,s){r.uniform3i(n(e),t,i,s)},e.uniform4i=function(e,t,i,s,o){r.uniform4i(n(e),t,i,s,o)},e.uniform1iv=function(e,t){r.uniform1iv(n(e),t)},e.uniform2iv=function(e,t){r.uniform2iv(n(e),t)},e.uniform3iv=function(e,t){r.uniform3iv(n(e),t)},e.uniform4iv=function(e,t){r.uniform4iv(n(e),t)},e.uniformVec2=function(e,t){r.uniform2f(n(e),t.x,t.y)},e.uniformVec3=function(e,t){r.uniform3f(n(e),t.x,t.y,t.z)},e.uniformVec4=function(e,t){r.uniform2f(n(e),t.x,t.y,t.z,t.w)},e.uniformMatrix2fv=function(e,t){r.uniformMatrix2fv(n(e),!1,t)},e.uniformMatrix3fv=function(e,t){r.uniformMatrix3fv(n(e),!1,t)},e.uniformMatrix4fv=function(e,t){r.uniformMatrix4fv(n(e),!1,t)},e.uniformMat2=function(e,t){r.uniformMatrix2fv(n(e),!1,[t[0],t[1],t[2],t[3]])},e.uniformMat3=function(e,t){r.uniformMatrix3fv(n(e),!1,[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]])},e.uniformMat4=function(e,t){r.uniformMatrix4fv(n(e),!1,[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]])},e._delete=function(){r.deleteProgram(e)},e.getDeleteStatus=function(){return r.getProgramParameter(e,r.DELETE_STATUS)},e},r.AutoProgram=function(e,t,n){var i=new r.Program,s=new r.VertexShader(e),o=new r.FragmentShader(t);return i.getVertexShader=function(){return s},i.getFragmentShader=function(){return o},i.attachShader(s),i.attachShader(o),i.bindAttribLocations(n),i.linkOrThrow(),i},r.AjaxProgram=function(e,t,n){var i=new r.Program;return OOGL.Ajax.get(e+".vert",function(s){var o=new r.VertexShader(s);i.attachShader(o),OOGL.Ajax.get(e+".frag",function(e){var s=new r.FragmentShader(e);i.attachShader(s),i.getVertexShader=function(){return o},i.getFragmentShader=function(){return s},i.bindAttribLocations(t),i.linkOrThrow(),n&&n.call(i)})}),i},r.Framebuffer=function(){var e=r.createFramebuffer();return e.is=function(){return r.isFramebuffer(e)},e.getAttachmentParameter=function(e,t){return r.getFramebufferAttachmentParameter(r.FRAMEBUFFER,e,t)},e.bind=function(){r.bindFramebuffer(r.FRAMEBUFFER,e)},e.checkStatus=function(){return r.checkFramebufferStatus(r.FRAMEBUFFER)},e.renderbuffer=function(e,t){r.framebufferRenderbuffer(r.FRAMEBUFFER,e,r.RENDERBUFFER,t)},e.texture2D=function(e,t,n,i){r.framebufferTexture2D(r.FRAMEBUFFER,e,t,n,i)},e._delete=function(){r.deleteFramebuffer(e)},e},r.Renderbuffer=function(){var e=r.createRenderbuffer();return e.is=function(){return r.isRenderbuffer(e)},e.getParameter=function(e){return r.getRenderbufferParameter(r.RENDERBUFFER,e)},e.getWidth=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_WIDTH)},e.getHeight=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_HEIGHT)},e.getInternalFormat=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_INTERNAL_FORMAT)},e.getRedSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_RED_SIZE)},e.getGreenSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_GREEN_SIZE)},e.getBlueSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_BLUE_SIZE)},e.getAlphaSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_ALPHA_SIZE)},e.getDepthSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_DEPTH_SIZE)},e.getStencilSize=function(){return r.getRenderbufferParameter(r.RENDERBUFFER,r.RENDERBUFFER_STENCIL_SIZE)},e.bind=function(){r.bindRenderbuffer(r.RENDERBUFFER,e)},e.storage=function(e,t,n){r.renderbufferStorage(r.RENDERBUFFER,e,t,n)},e._delete=function(){r.deleteRenderbuffer(e)},e},r},OOGL.RenderLoop=function(){var e="auto",t=60,n=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,r=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame,i=function(e,t){var i=Math.floor(1e3/t);return function(s){function h(){var e=null;this.start=function(){e===null&&(e=n(function t(){a++,s(),e=n(t)}))},this.stop=function(){e!==null&&(r(e),e=null)}}function p(){var e=null;this.start=function(){e===null&&(e=setInterval(function(){a++,s()},i))},this.stop=function(){e!==null&&(clearInterval(e),e=null)}}var o=!1,u=!1,a=0,f,l=0,c,d;switch(e){case"request":d=new h;break;case"interval":d=new p;break;default:n?(e="request",d=new h):(e="interval",d=new p)}this.getType=function(){return e},this.getRate=function(){return t},this.getPeriod=function(){return i},this.getActualRate=function(){var e;u?e=c:e=Date.now();var t=a/(e-f-l);return a=0,f=e,l=0,t},this.start=function(){!o&&!u&&(o=!0,f=Date.now(),d.start())},this.suspend=function(){o&&(u=!0,c=Date.now(),d.stop())},this.resume=function(){o&&(u=!1,l+=Date.now()-c,d.start())},this.stop=function(){o=!1,u=!0,c=Date.now(),d.stop()}}}(e,t);return i.isRequestAnimationFrameSupported=function(){return!!n},i.getType=function(){return e},i.setType=function(t){if(!{request:!0,interval:!0,auto:!0}.hasOwnProperty(e))throw"invalid loop type, must be one of `request`, `interval` or `auto`.";e=t},i.getRate=function(){return t},i.getPeriod=function(){return Math.floor(1e3/t)},i.setRate=function(e){t=e},i}();